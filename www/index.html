<!DOCTYPE html>
<html>

    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

		<!--
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width">
		-->
		
        <meta name="viewport" content="width=device-width, initial-scale = 1.0, maximum-scale=1.0, user-scalable=no" />

        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>

        <title>Kool Cruise</title>

		
        <link rel="stylesheet" href="css/jquery.mobile.theme.css">
		
		
        <link rel="stylesheet" href="css/listings.css">     
		
		
        <link rel="stylesheet" type="text/css" href="css/jquery-mobile-i.css"/>
		
		
        <link rel="stylesheet" href="css/font.css"> 
        <link rel="stylesheet" href="css/hamburger.css">

        <script src="js/jquery-1.10.2.min.js"></script>
        <script src="js/jquery.mobile-1.4.2.min.js"></script>
        <script src="js/jquery.animateNumber.min.js"></script>
		<script src="js/jquery-ui.js"></script>
        <script src="js/hamburger.js"></script>


        <!-- Home screen icons -->
        <script type="text/javascript">
            document.addEventListener("deviceready", onDeviceReady, false);
            function onDeviceReady() {
                navigator.splashscreen.hide();
                document.addEventListener("touchstart", function() {
                }, false);
            }

            $(document).on("mobileinit", function() {
                $.mobile.loader.prototype.options.text = "loading";
                $.mobile.loader.prototype.options.textVisible = false;
                $.mobile.loader.prototype.options.theme = "d";
                $.mobile.loader.prototype.options.html = "";
            });

            WebFont.load({
                google: {
                    families: ['Open Sans']
                }
            });
        </script>
        <style>
            element:hover, element:active {
                -webkit-tap-highlight-color: rgba(0,0,0,0);
                -webkit-user-select: none;
                -webkit-touch-callout: none
            }
        </style>
    </head>

    <body>
	
	
	
		
			<!--The mobile navigation Markup hidden via css-->
			<nav class="mobileNav">
				<ul>
					<li><a href="javascript:gotoHomePage();" data-direction="reverse" data-transition="slide">Home</a></li>
					<li><a href="#" data-direction="reverse" data-transition="slide">My Favourites</a></li>
				</ul>
			</nav>
			<!--The mobile navigation Markup hidden via css-->
		
			<div data-role="page" id="main-page" data-theme="i" >
				<div data-role="header"  data-theme="i" class="fix-header"> 
					<div class="header secondary-title">Kool Cruise</div>
					<!--The Hamburger Button in the Header [Starts Here]-->
					<header>
						<div id="hamburger" onclick="toggleHB('main-page')">
							<div></div>
							<div></div>
							<div></div>
						</div>
					</header>	
					<!--The Hamburger Button in the Header [Ends Here]-->							
				</div>			

				<div id="themeWraper" class="wrapper theme-col touch">

					<span id="family"  class="thumbimg" data-contentdata="theme"  onclick="javascript:themeSelector('family');" >
						<img src="img/theme/family.png" width="" height="" />
						<span class="mask"></span>
						<span class="text">Family</span>
					</span>

					<span id="romantic"  class="thumbimg" data-contentdata="theme" onclick="javascript:themeSelector('romantic');">
						<img src="img/theme/romantic.png" width="" height="" />
						<span class="mask"></span>
						<span class="text">Romantic</span>
					</span>

					<span id="single"  class="thumbimg" data-contentdata="theme" onclick="javascript:themeSelector('single');">
						<img src="img/theme/single.png" width="" height="" />
						<span class="mask"></span>
						<span class="text">Single</span>
					</span>

					<span id="beach"  class="thumbimg" data-contentdata="theme" onclick="javascript:themeSelector('beach');">
						<img src="img/theme/beach.png" width="" height="" />
						<span class="mask"></span>
						<span class="text">Beach</span>
					</span>

					<!--
	<span id="shopping"  class="thumbimg" data-contentdata="theme" onclick="javascript:themeSelector('shopping');">
	<img src="img/theme/shopping.png" width="" height="" />
	<span class="mask"></span>
	<span class="text">Shopping</span>
	</span>
					-->
					<!--
	<span id="senior"  class="thumbimg" data-contentdata="theme" onclick="javascript:themeSelector('senior');">
	<img src="img/theme/senior.png" width="" height="" />
	<span class="mask"></span>
	<span class="text">Senior</span>
	</span>
					-->

					<span id="cultural"  class="thumbimg" data-contentdata="theme" onclick="javascript:themeSelector('cultural');">
						<img src="img/theme/cultural.png" width="" height="" />
						<span class="mask"></span>
						<span class="text">Cultural</span>
					</span>
					<!--
	<span id="sports"  class="thumbimg" data-contentdata="theme" onclick="javascript:themeSelector('sports');">
	<img src="img/theme/sports.png" width="" height="" />
	<span class="mask"></span>
	<span class="text">Sports</span>
	</span>
					-->
					<span id="summer"  class="thumbimg" data-contentdata="theme" onclick="javascript:themeSelector('summer');">
						<img src="img/theme/summer.png" width="" height="" />
						<span class="mask"></span>
						<span class="text">Summer</span>
					</span>

				</div>


				<div id="destinationWraper" class="wrapper dest-col touch">                      
					<span id="alaska"  class="thumbimg" data-contentdata="destination" onclick="javascript:destinationSelector('alaska');">
						<img src="img/destination/alaska.png" width="" height=""  />
						<span class="mask"></span>
						<span class="text">Alaska</span>
					</span>

					<span id="bahamas"  class="thumbimg" data-contentdata="destination" onclick="javascript:destinationSelector('bahamas');">
						<img src="img/destination/florida.png" width="" height=""  />
						<span class="mask"></span>
						<span class="text">Bahamas <br /> & </>Florida</span>
					</span>

					<span id="bermuda"  class="thumbimg" data-contentdata="destination" onclick="javascript:destinationSelector('bermuda');">
						<img src="img/destination/bermuda.png" width="" height=""  />
						<span class="mask"></span>
						<span class="text">Bermuda</span>
					</span>      

					<span id="caribbean"  class="thumbimg" data-contentdata="destination" onclick="javascript:destinationSelector('caribbean');">
						<img src="img/destination/caribbean.png" width="" height="" />
						<span class="mask"></span>
						<span class="text">Caribbean</span>
					</span>

					<!--  
	<span id="canada"  class="thumbimg" data-contentdata="destination" onclick="javascript:destinationSelector('canada');">
	<img src="img/destination/canada-newengland.png" width="" height=""  />
	<span class="mask"></span>
	<span class="text">Canada <br />& New England</span>
	</span>
					-->

					<span id="europe"  class="thumbimg" data-contentdata="destination" onclick="javascript:destinationSelector('europe');">
						<img src="img/destination/europe.png" width="" height=""  />
						<span class="mask"></span>
						<span class="text">Europe</span>
					</span>

					<!--
	<span id="southamerica"  class="thumbimg" data-contentdata="destination" onclick="javascript:destinationSelector('southamerica');">
	<img src="img/destination/southamerica.png" width="" height=""  />
	<span class="mask"></span>
	<span class="text">South America</span>
	</span>
					-->

				</div>

				<div class="clearfix"></div>

				<div  class="booking-btn" data-theme="i">
					<a id="cruiseCount"  href="javascript:viewList();" data-role="none" data-transition="slide" data-theme="i" class="booknow  fixedfooter">Show <span id="cruiseSpanCount">16</span> Cruises </a>
				</div>

			</div>


			<!-- Property List Page two Starts Here -->

			<div data-role="page" id="Prop-card" data-theme="i" class="fix-header">
				<div data-role="header"  data-theme="i">
					<a href="javascript:gotoMain();" data-role="button" data-direction="reverse" data-transition="slide"> <span class="icon icon-caret01 prev-caret"></span> <span class="back"></span></a>
					<div  id="listHCount" class="header secondary-title">Cruises</div>
					
					<!--The Hamburger Button in the Header [Starts Here]-->
					<header>
						<div id="hamburger" onclick="toggleHB('Prop-card')">
							<div></div>
							<div></div>
							<div></div>
						</div>
					</header>	
					<!--The Hamburger Button in the Header [Ends Here]-->				
					
				</div>

				<!--  List Page Item Card Template [Starts Here] -->
				<div id="listTemplate" style="display:none;">

					<div class="container">
						<div class="img">
							<a  href="javascript:viewDetails('#cid#')" href="#pro-details" data-role="none" data-transition="slide">
								<img src="#img#" width="100%" height="" />
								<div class="list-gradiant gradiant-box"></div>
								<span class="mask"></span>
								<div class="wrap2">
									<span class="price">
										<span class="dolar">USD</span><span class="amount">#price#</span>
										<span class="onwards">Onwards</span>
									</span>                                   
								</div>
								<div class="details">
									<div class="wrap1">
										<div class="icon icon-#rating#"></div>
										<h2 class="trip-name">#name# </h2>
										<div class="trip-type"><span>#dfrom#</span> <span class="dot">.</span> <span>#ndate#</span></div>
									</div>
								</div> 
							</a> 								
						</div>
					</div>

				</div>
				<!--  List Page Item Card Template [Ends Here] -->

				<div id="listPageWrapper" class="wrapper pagewrapper"  data-theme="i" >  
				</div>   


				<div class="footer fixedfooter">
					<div class="filtermask"></div>
					<div class="filterlinks">
						<!--<div class="filters-text">Filters</div>-->
						<div class="filters">
							<ul id="filterList">
								<li id="all" onclick="filterDuration(this, 'all')" class="selected">Any <br /></li>
								<li id="fewdays" onclick="filterDuration(this, 'fewdays')" >Few <br />Days</li>
								<li id="oneweek" onclick="filterDuration(this, 'oneweek')" >1 <br />Week</li>
								<li id="twoweek" onclick="filterDuration(this, 'twoweek')" >2 <br />Weeks</li>
								<li id="15days"  onclick="filterDuration(this, '15days')" >2+ <br />Weeks</li>
							</ul>
						</div>
					</div>
				</div>

			</div>


			<!-- Proporty List Page Ends Here -->


			<!-- Property Details Page Starts Here -->
			<!-- Property Details Page Ends Here -->



		
        <script src="cordova.js"></script>     
    </body>
    <script type="text/javascript">

		$(document).ready(function() {
			var _heightBody = $(window).height() - $(".fixedfooter").height() - 90;
			$(".wrapper").css({"height": (_heightBody) + "px", "overflow-y": "scroll;"});
			$('.svg-inject').svgInject();
		});

		refreshCount();

		var themeSelected = '';
		var destinationSelected = '';
		var durationSelected = '';
		var cruisesFound = 0;
		var cruiseList = '';
		var listHtml = '';
		var currentCID = '';
		var cruiseJsonDetails = '';
		////////////////////////////////////////////////////////////////////////////////////
		function themeSelector(themSel) {

			if (themeSelected == themSel) {
				$("#themeWraper span span").removeClass("selected");
				themeSelected = '';
				refreshCount();
			} else {
				themeSelected = themSel;
				$("#themeWraper span span").removeClass("selected");
				$("#" + themeSelected + " span").addClass("selected");
				refreshCount();
			}

		}
		////////////////////////////////////////////////////////////////////////////////////
		function destinationSelector(destSel) {
			if (destinationSelected == destSel) {
				$("#destinationWraper span span").removeClass("selected");
				destinationSelected = '';
				refreshCount();
			} else {
				destinationSelected = destSel;
				$("#destinationWraper span span").removeClass("selected");
				$("#" + destinationSelected + " span").addClass("selected");
				refreshCount();
			}
		}
		////////////////////////////////////////////////////////////////////////////////////
		var maxCount = 16;
		var textOnMax = $('#cruiseSpanCount').text();
		var currentCount = maxCount;

		function refreshCount() {

			$('#cruiseSpanCount').prop('number', currentCount).animateNumber({number: maxCount},
			{
				complete: function(e) {
					currentCount = updateCount()
				}
			});


		}
		////////////////////////////////////////////////////////////////////////////////////
		function updateCount() {
			if (jQuery.isEmptyObject(cruiseList) || cruiseList == '') {
				showLoader();
				initJsonObject();
				hideLoader();
			} else {
				calculateCount();
			}
			//unBlockViewCruises();
			return cruisesFound;
		}
		////////////////////////////////////////////////////////////////////////////////////
		function getRandomInt(min, max) {
			return Math.floor(Math.random() * (max - min)) + min;
		}
		////////////////////////////////////////////////////////////////////////////////////
		function calculateCount() {
			listHtml = '';
			cruisesFound = 0;
			if (themeSelected == '' && destinationSelected == '') {
				for (var i = 0, len = cruiseList.length; i < len; i++) {
					if (durationSelected == '' || cruiseList[i].filterDuration == durationSelected) {
						listHtml = listHtml.concat(buildCard(cruiseList[i].cruiseId, cruiseList[i].destinationImages[0], cruiseList[i].cruiseName, cruiseList[i].destinationFrom, cruiseList[i].startingFrom, cruiseList[i].priceFrom, cruiseList[i].shipOverallRating));
						cruisesFound++;
					}
				}
			} else {
				cruisesFound = 0;
				for (var i = 0, len = cruiseList.length; i < len; i++) {
					if (themeSelected != ''
							&& destinationSelected != ''
							&& cruiseList[i].filterDestination.indexOf(destinationSelected) > -1
							&& cruiseList[i].filterLifestyle.indexOf(themeSelected) > -1) {

						if (durationSelected == '' || cruiseList[i].filterDuration == durationSelected) {
							cruisesFound++;
							listHtml = listHtml.concat(buildCard(cruiseList[i].cruiseId, cruiseList[i].destinationImages[0], cruiseList[i].cruiseName, cruiseList[i].destinationFrom, cruiseList[i].startingFrom, cruiseList[i].priceFrom, cruiseList[i].shipOverallRating));
						}
					} else if (themeSelected == '' && destinationSelected != '' && cruiseList[i].filterDestination.indexOf(destinationSelected) > -1) {
						if (durationSelected == '' || cruiseList[i].filterDuration == durationSelected) {
							cruisesFound++;
							listHtml = listHtml.concat(buildCard(cruiseList[i].cruiseId, cruiseList[i].destinationImages[0], cruiseList[i].cruiseName, cruiseList[i].destinationFrom, cruiseList[i].startingFrom, cruiseList[i].priceFrom, cruiseList[i].shipOverallRating));
						}
					} else if (destinationSelected == '' && themeSelected != '' && cruiseList[i].filterLifestyle.indexOf(themeSelected) > -1) {
						if (durationSelected == '' || cruiseList[i].filterDuration == durationSelected) {
							cruisesFound++;
							listHtml = listHtml.concat(buildCard(cruiseList[i].cruiseId, cruiseList[i].destinationImages[0], cruiseList[i].cruiseName, cruiseList[i].destinationFrom, cruiseList[i].startingFrom, cruiseList[i].priceFrom, cruiseList[i].shipOverallRating));
						}
					}//endif
				}//endfor		  
			}//endif

			if (cruisesFound > 1) {
				$('#cruiseSpanCount').animateNumber({number: cruisesFound});
				//$("#cruiseCount").html("Show <span id='cruiseSpanCount'> "+cruisesFound+" </span> Cruises"); 
				//$("#listHCount").html(cruisesFound+" Cruises Found"); 	
			} else if (cruisesFound == 1) {
				$('#cruiseSpanCount').animateNumber({number: cruisesFound});
				//$("#cruiseCount").html("View "+cruisesFound+" Cruise"); 	
				//$("#listHCount").html(cruisesFound+" Cruise Found"); 	
			} else {
				$("#cruiseCount").html("<span id='cruiseSpanCount'> No </span> Cruises Found");
				$("#listHCount").html("No Cruises Found!");
			}

		}
		////////////////////////////////////////////////////////////////////////////////////
		function initJsonObject() {
			var jsonUrl = 'http://107.161.124.98:8080/zap-capi-1.0/rest/cruise/list';

			$.getJSON(jsonUrl, function(data) {
				cruiseList = data.cruiseList;
				calculateCount();
			});

		}
		////////////////////////////////////////////////////////////////////////////////////
		function blockViewCruises() {
			//$("#cruiseCount").addClass("disabled");
			//$("#cruiseCount").html("<img src='css/images/ajax-loader.gif' height='29'/>");
		}
		////////////////////////////////////////////////////////////////////////////////////
		function unBlockViewCruises() {
			//$("#cruiseCount").removeClass("disabled");
		}
		////////////////////////////////////////////////////////////////////////////////////		
		function buildCard(cid, img, name, dfrom, ndate, price, rating) {
			var itemTemplate = $("#listTemplate").html();

			itemTemplate = itemTemplate.replace("#cid#", cid);
			itemTemplate = itemTemplate.replace("#img#", img);
			itemTemplate = itemTemplate.replace("#name#", name);
			itemTemplate = itemTemplate.replace("#dfrom#", dfrom);
			itemTemplate = itemTemplate.replace("#ndate#", ndate);
			itemTemplate = itemTemplate.replace("#price#", price);
			itemTemplate = itemTemplate.replace("#rating#", rating);
			return itemTemplate;
		}

		function viewList() {
			showLoader();
			$("#listPageWrapper").html(listHtml);
			$("#all").addClass("selected");
			$.mobile.navigate("#Prop-card");
		}

		////////////////////////////////////////////////////////////////////////////////////
		function showLoader() {
			$.mobile.loading('show', {
				text: 'Loading',
				textVisible: true,
				theme: 'd',
				textonly: false,
				html: ''
			});
		}
		////////////////////////////////////////////////////////////////////////////////////
		function hideLoader() {
			$.mobile.loading('hide', {
				text: 'Loading',
				textVisible: true,
				theme: 'd',
				textonly: false,
				html: ''
			});
		}
		////////////////////////////////////////////////////////////////////////////////////	
		function viewDetails(cid) {
			currentCID = cid;
			cruiseJsonDetails = '';
			showLoader();
			//$("body").append("<div id='pro-details'><img src='css/images/ajax-loader.gif' height='29'/></div>");

			var detailsJsonUrl = 'http://107.161.124.98:8080/zap-capi-1.0/rest/cruise/details/' + cid + '/cruiseid';
			$.getJSON(detailsJsonUrl, function(data) {
				cruiseJsonDetails = data;
			});

			var detailsUrl = 'http://107.161.124.98:8080/zap-capi-1.0/rest/html/cruise/details/' + cid + '/cruiseid';
			$.ajax({
				type: "GET",
				url: detailsUrl,
				cache: false,
				dataType: "html",
				success: onSuccess,
				error: fatalErrorGot
			});


			//hideLoader();

		}
		////////////////////////////////////////////////////////////////////////////////////
		function onSuccess(data) {

			$("#pro-details").remove();

			$("div[id$=detail]").each(function(index) {
				$(this).remove();
			});

			$("body").append(data);
			$.mobile.navigate("#pro-details");
		}
		////////////////////////////////////////////////////////////////////////////////////
		function fatalErrorGot(request, status, error) {
			alert('Error Occurred ' + error);
		}
		////////////////////////////////////////////////////////////////////////////////////
		function refreshPrice(obj, cid, pdate) {
			if (cruiseJsonDetails != '') {
				var itenaryDates = cruiseJsonDetails.cruiseDetails.itineraryDates;
				for (var i = 0, len = itenaryDates.length; i < len; i++) {
					if (pdate == itenaryDates[i].date) {
						for (var j = 0, jlen = itenaryDates[i].itineraryPrice.length; j < jlen; j++) {
							var catName = itenaryDates[i].itineraryPrice[j].categoryName;
							var catPrice = itenaryDates[i].itineraryPrice[j].leadPrice;
							catName = catName.replace(/\s+/g, '-');
							$("#" + catName + "-ds4").html(catPrice);
							/////////////////////////////////////
							//if(catPrice.indexOf('S') > -1 || catPrice.indexOf('N') > -1){
							//   $(".dollar").html("");
							//}else{
							//   $(".dollar").html("$");
							//}
							/////////////////////////////////////
						}//endforj
					}//endif
				}//endfori
				var newDate = pdate + "-dsa";
				$(".active-select-date").removeClass("active-select-date");
				obj.className = obj.className + " active-select-date";

			}
		}
		////////////////////////////////////////////////////////////////////////////////////
		function filterDuration(obj, nodays) {

			if (obj.className == 'selected') {
				$("#" + nodays).removeClass("selected");
				durationSelected = '';
			} else {
				$("#filterList li").each(function(index) {
					$(this).removeClass("selected");
				});
				$("#" + nodays).addClass("selected");

				if (nodays != 'all') {
					durationSelected = nodays;
				} else {
					durationSelected = '';
				}
			}
			
			refreshCount();
			$("#listPageWrapper").html(listHtml);
		}
		////////////////////////////////////////////////////////////////////////////////////
		function gotoMain() {
			durationSelected = '';
			$("#filterList li").each(function(index) {
				$(this).removeClass("selected");
			});
			refreshCount();
			$.mobile.navigate("#main-page");

		}
		////////////////////////////////////////////////////////////////////////////////////
		function selectPrice(obj, deckSel) {

			if (obj.className == 'deck-price active-select-price') {
				$("#" + deckSel + "-ds1").removeClass("selected");
				$("#" + deckSel + "-ds2").removeClass("active-select-price");
				$("#" + deckSel + "-ds2").removeClass("active-select-deck");
				$("#" + deckSel + "-ds3").removeClass("active-select-price");
			} else {


				$("#deckWrapperId div").each(function(index) {
					$(this).removeClass("selected");
				});

				$("#deckWrapperId div a div").each(function(index) {
					$(this).removeClass("active-select-deck");
				});

				$("#deckWrapperId div div").each(function(index) {
					$(this).removeClass("active-select-price");
				});


				$("#" + deckSel + "-ds1").addClass("selected");
				$("#" + deckSel + "-ds2").addClass("active-select-deck");
				$("#" + deckSel + "-ds3").addClass("active-select-price");

			}
		}
		////////////////////////////////////////////////////////////////////////////////////
    </script>			
</html>
